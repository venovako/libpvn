\documentclass[a4paper,12pt,twoside]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{url}
\newtheorem{thm}{Theorem}
\newtheorem{lem}{Lemma}
\title{Complex hyperbolic $2\times 2$ rotations}
\author{Vedran Novakovi\'{c}\footnote{with suggestions from Vjeran Hari}}
\begin{document}
\maketitle
\section{Formulas}
Let $V\in\mathbb{C}^{2\times 2}$ be $J$-unitary and let
$A\in\mathbb{C}^{2\times 2}$ be a Hermitian positive semidefinite
matrix such that $2|a_{21}|<a_{11}+a_{22}$, where
\begin{equation}
  A=\begin{bmatrix}
  a_{11} & \overline{a_{21}}\\
  a_{21} & a_{22}
  \end{bmatrix},\quad
  J=\begin{bmatrix}
  1 & \hphantom{-}0\\
  0 & -1
  \end{bmatrix},\quad
  V=\begin{bmatrix}
  \hphantom{\mathrm{e}^{\mathrm{i}\beta}}\cosh\phi & \mathrm{e}^{-\mathrm{i}\beta}\sinh\phi\\
  \mathrm{e}^{\mathrm{i}\beta}\sinh\phi & \hphantom{\mathrm{e}^{-\mathrm{i}\beta}}\cosh\phi
  \end{bmatrix}.
  \label{e:1}
\end{equation}
Then, $V^{\ast}=V$ and $V^{\ast}JV=VJV^{\ast}=J$.  Find $\beta$ and
$\phi$ such that $V^{\ast}AV=\Xi$,
\begin{equation}
  \Xi\!=\!\begin{bmatrix}
  \xi_1 & \!\!0\\
  0 & \!\!\xi_2
  \end{bmatrix}\!=\!\begin{bmatrix}
  \hphantom{\mathrm{e}^{\mathrm{i}\beta}}\cosh\phi & \!\mathrm{e}^{-\mathrm{i}\beta}\sinh\phi\\
  \mathrm{e}^{\mathrm{i}\beta}\sinh\phi & \!\hphantom{\mathrm{e}^{-\mathrm{i}\beta}}\cosh\phi
  \end{bmatrix}\!\!\begin{bmatrix}
  a_{11} & \!\overline{a_{21}}\\
  a_{21} & \!a_{22}
  \end{bmatrix}\!\!\begin{bmatrix}
  \hphantom{\mathrm{e}^{\mathrm{i}\beta}}\cosh\phi & \!\mathrm{e}^{-\mathrm{i}\beta}\sinh\phi\\
  \mathrm{e}^{\mathrm{i}\beta}\sinh\phi & \!\hphantom{\mathrm{e}^{-\mathrm{i}\beta}}\cosh\phi
  \end{bmatrix}.
  \label{e:2}
\end{equation}
Dividing~\eqref{e:2} by $\cosh^2\phi>0$ gives, with
$\xi_i'=\xi_i^{}/\cosh^2\phi$,
\begin{equation}
  \begin{bmatrix}
  \hphantom{\mathrm{e}^{\mathrm{i}\beta}}1 & \!\mathrm{e}^{-\mathrm{i}\beta}\tanh\phi\\
  \mathrm{e}^{\mathrm{i}\beta}\tanh\phi & \!\hphantom{\mathrm{e}^{-\mathrm{i}\beta}}1
  \end{bmatrix}\!\!\begin{bmatrix}
  a_{11}^{} & \!\overline{a_{21}^{}}\\
  a_{21}^{} & \!a_{22}^{}
  \end{bmatrix}\!\!\begin{bmatrix}
  \hphantom{\mathrm{e}^{\mathrm{i}\beta}}1 & \!\mathrm{e}^{-\mathrm{i}\beta}\tanh\phi\\
  \mathrm{e}^{\mathrm{i}\beta}\tanh\phi & \!\hphantom{\mathrm{e}^{-\mathrm{i}\beta}}1
  \end{bmatrix}\!=\!\begin{bmatrix}
  \xi_1' & \!0\\
  0 & \!\xi_2'
  \end{bmatrix}.
  \label{e:3}
\end{equation}
Multiplying the first two matrices in~\eqref{e:3} gives
\begin{displaymath}
  \Xi'=\begin{bmatrix}
  a_{11}^{}+a_{21}^{}\mathrm{e}^{-\mathrm{i}\beta}\tanh\phi & \overline{a_{21}^{}}+a_{22}^{}\mathrm{e}^{-\mathrm{i}\beta}\tanh\phi\\
  a_{11}^{}\mathrm{e}^{\mathrm{i}\beta}\tanh\phi+a_{21}^{} & \overline{a_{21}^{}}\mathrm{e}^{\mathrm{i}\beta}\tanh\phi+a_{22}^{}
  \end{bmatrix}\!\!\begin{bmatrix}
  \hphantom{\mathrm{e}^{\mathrm{i}\beta}}1 & \!\mathrm{e}^{-\mathrm{i}\beta}\tanh\phi\\
  \mathrm{e}^{\mathrm{i}\beta}\tanh\phi & \!\hphantom{\mathrm{e}^{-\mathrm{i}\beta}}1
  \end{bmatrix},
\end{displaymath}
with the final multiplication producing, elementwise,
\begin{eqnarray}
    \xi_1'=&a_{11}^{}+(2\Re(a_{21}^{}\mathrm{e}^{-\mathrm{i}\beta})+a_{22}^{}\tanh\phi)\tanh\phi,\label{e:4}\\
    0=&\overline{a_{21}^{}}+(a_{11}^{}+a_{22}^{}+a_{21}^{}\mathrm{e}^{-\mathrm{i}\beta}\tanh\phi)\mathrm{e}^{-\mathrm{i}\beta}\tanh\phi,\label{e:5}\\
    0=&a_{21}^{}+(a_{11}^{}+a_{22}^{}+\overline{a_{21}^{}}\mathrm{e}^{\mathrm{i}\beta}\tanh\phi)\mathrm{e}^{\mathrm{i}\beta}\tanh\phi,\label{e:6}\\
    \xi_2'=&a_{22}^{}+(2\Re(a_{21}^{}\mathrm{e}^{-\mathrm{i}\beta})+a_{11}^{}\tanh\phi)\tanh\phi,\label{e:7}
\end{eqnarray}
since $z+\bar{z}=2\Re{z}$.  Evidently, $\xi_i\in\mathbb{R}$.  If
$a_{21}=0$ then $\tanh\phi=0$, and vice versa, if $\tanh\phi=0$, then
from~\eqref{e:5} (or~\eqref{e:6}, which is the complex conjugate
of~\eqref{e:5}) it follows $a_{21}=0$.  Therefore, assume in the
following that $\tanh\phi\ne 0$.

Multiplying~\eqref{e:5} by $\mathrm{e}^{\mathrm{i}\beta}$
and~\eqref{e:6} by $\mathrm{e}^{-\mathrm{i}\beta}$, it follows
\begin{eqnarray}
  0=&\overline{a_{21}^{}}\mathrm{e}^{\mathrm{i}\beta}+(a_{11}^{}+a_{22}^{})\tanh\phi+a_{21}^{}\mathrm{e}^{-\mathrm{i}\beta}\tanh^2\phi,\label{e:8}\\
  0=&a_{21}^{}\mathrm{e}^{-\mathrm{i}\beta}+(a_{11}^{}+a_{22}^{})\tanh\phi+\overline{a_{21}^{}}\mathrm{e}^{\mathrm{i}\beta}\tanh^2\phi.\label{e:9}
\end{eqnarray}
By extracting the common middle term on the right hand sides of~\eqref{e:8} and~\eqref{e:9},
\begin{eqnarray}
  -(a_{11}^{}+a_{22}^{})\tanh\phi=\overline{a_{21}^{}}\mathrm{e}^{\mathrm{i}\beta}+a_{21}^{}\mathrm{e}^{-\mathrm{i}\beta}\tanh^2\phi,\label{e:10}\\
  -(a_{11}^{}+a_{22}^{})\tanh\phi=a_{21}^{}\mathrm{e}^{-\mathrm{i}\beta}+\overline{a_{21}^{}}\mathrm{e}^{\mathrm{i}\beta}\tanh^2\phi,\label{e:11}
\end{eqnarray}
it follows that the right hand sides of~\eqref{e:10} and~\eqref{e:11}
have to be equal,
\begin{equation}
  \overline{a_{21}^{}}\mathrm{e}^{\mathrm{i}\beta}+a_{21}^{}\mathrm{e}^{-\mathrm{i}\beta}\tanh^2\phi=a_{21}^{}\mathrm{e}^{-\mathrm{i}\beta}+\overline{a_{21}^{}}\mathrm{e}^{\mathrm{i}\beta}\tanh^2\phi,
  \label{e:12}
\end{equation}
while at the same time being the complex conjugates of one another.
Therefore, both sides in~\eqref{e:12} are real, what~\eqref{e:10}
and~\eqref{e:11} also suggest.  With
\begin{equation}
  \beta=\arg(a_{21}),\quad\text{i.e.,}\quad\mathrm{e}^{\mathrm{i}\beta}=\frac{a_{21}}{|a_{21}|},\quad(a_{21}=0\implies\beta=0),
  \label{e:13}
\end{equation}
this condition is always fulfilled.  If $a_{21}$ is real
in~\eqref{e:1}, then
$\mathrm{e}^{\mathrm{i}\beta}=\mathop{\mathrm{sign}}{a_{21}}$.

Now, \eqref{e:8} and~\eqref{e:9} become
\begin{equation}
  |a_{21}|(1+\tanh^2\phi)=-(a_{11}+a_{22})\tanh\phi,
  \label{e:14}
\end{equation}
or, after rearranging~\eqref{e:14},
\begin{equation}
  \frac{-|a_{21}|}{a_{11}+a_{22}}=\frac{\tanh\phi}{1+\tanh^2\phi}=\frac{1}{2}\tanh(2\phi).
  \label{e:15}
\end{equation}
Note that $a_{11}\ge 0$ and $a_{22}\ge 0$ by definition, so
$a_{11}+a_{22}=0$ if and only if $a_{11}=0$ and $a_{22}=0$, in which
case $a_{21}=0$, and thus~\eqref{e:15} does not even have to be
evaluated in this degenerate case to compute $\tanh\phi=0$.

The proper sequence of checks on the inputs $a_{11}$, $a_{22}$, and
$a_{21}$ is thus
\begin{enumerate}
\item if $a_{11}<0$ then ERROR; else
\item if $a_{22}<0$ then ERROR; else
\item if $a_{21}'=0$ then $\tanh\phi=0$,
\end{enumerate}
where $a_{21}'$ is $a_{21}^{}$, scaled as in~\eqref{e:20}.  Else,
proceed to compute $\tanh(2\phi)$.

If the computed $\tanh(2\phi)\le-1$, then setting $\tanh(2\phi)=-1$
allows the computation to proceed, to get $\cosh\phi=\infty$ and
$|\sinh\phi|=\infty$.  The input in this case is invalid, and then it
is up to the caller to provide a remedy.

Alternatively, the hyperbolic cotangent of $2\phi$ might be computed
as:
\begin{equation}
  \coth(2\phi)=\frac{a_{11}+a_{22}}{-2|a_{21}|},
  \label{e:16}
\end{equation}
but this can easily cause overflow for small $|a_{21}|$.  On the other
hand, underflow of $\tanh(2\phi)$, as long as it is not exactly zero,
will cause no trouble in the further computation, and might preserve
at least some information, possibly resulting in a non-zero
$\tanh\phi$ as well.

\looseness=-1
There are two solutions for the quadratic equation for $\tanh\phi$
from~\eqref{e:15}, only one of which obeys $|\tanh\phi|<1$,
\begin{equation}
  \tanh\phi=\frac{1-\sqrt{1-\tanh^2(2\phi)}}{\tanh(2\phi)}.
  \label{e:17}
\end{equation}
However, if the numerator and the denominator in~\eqref{e:17} are
multiplied by $1+\sqrt{1-\tanh^2(2\phi)}$, a more stable form emerges,
\begin{equation}
  \begin{split}
    \tanh\phi&=\frac{1-\sqrt{1-\tanh^2(2\phi)}}{\tanh(2\phi)}\cdot\frac{1+\sqrt{1-\tanh^2(2\phi)}}{1+\sqrt{1-\tanh^2(2\phi)}}\\
    &=\frac{1-(1-\tanh^2(2\phi))}{\tanh(2\phi)\left(1+\sqrt{1-\tanh^2(2\phi)}\right)}\\
    &=\frac{\tanh(2\phi)}{1+\sqrt{1-\tanh^2(2\phi)}}\approx\frac{\tanh(2\phi)}{1+\mathop{\mathrm{sqrt}}(\mathop{\mathrm{fma}}(-\tanh(2\phi),\tanh(2\phi),1))}.
  \end{split}
  \label{e:18}
\end{equation}
Since $|\tanh(2\phi)|<1$, from~\eqref{e:18} it follows that
$|\tanh\phi|<1$ as well.  Now,
\begin{equation}
  \begin{aligned}
    \cosh\phi&=\frac{1}{\sqrt{1-\tanh^2\phi}}\approx\mathop{\mathrm{rsqrt}}(\mathop{\mathrm{fma}}(-\tanh\phi,\tanh\phi,1)),\\
    \sinh\phi&=\tanh\phi\cdot\cosh\phi.
  \end{aligned}
  \label{e:19}
\end{equation}
If $\tanh\phi$ is regarded as a computed floating-point value, then
$|\tanh\phi|\le 1^-$, where $1^-$ is the first floating-point
predecessor of unity.  Otherwise, the computed $|\tanh(2\phi)|$ would
have to be unity, what has already been ruled out.  Thus,
\begin{displaymath}
  \tanh^2\phi<|\tanh\phi|\le 1^-\implies 1-\tanh^2\phi\ge 1-1^-.
\end{displaymath}
Since $1-1^-$ is a floating-point value in the normal range, its
square root is as well, so $\cosh\phi$ cannot overflow
in~\eqref{e:19}, and neither can $\sinh\phi$.

The input data has to be prescaled by the highest possible power of
two, $2^s$, to get $a_{11}'=2^s a_{11}^{}$, $a_{22}'=2^s a_{22}^{}$,
and $a_{21}'=2^s a_{21}^{}$, such that
\begin{equation}
  \max\{a_{11}',a_{22}'\}\le\nu/2,\quad
  \max\{|\Re{a_{21}'}|,|\Im{a_{21}'}|\}\le\nu/2,
  \label{e:20}
\end{equation}
where $\nu$ is the largest finite floating-point value.  This way no
quantity in~\eqref{e:15} will overflow, and the chances of dealing
with subnormal values will be minimized.  See the scaling of $A$ and
the computation of $\mathrm{e}^{\mathrm{i}\beta}$
in:\\\url{https://doi.org/10.1016/j.cam.2024.116003}
\section{Accuracy}
Let the computed values, unlike the exact ones, be
\underline{underlined} in the following, let $\varepsilon$ be the
machine precision, and assume $\mathrm{hypot}$ is correctly rounded.

Also, assume that all inputs have been scaled exactly to $a_{11}'$,
$a_{22}'$, $a_{21}'$.

\begin{lem}\label{l:1}
  If $|\tanh(2\phi)|\le 40/41$ then $|\tanh\phi|\le 4/5$, and vice
  versa.
\end{lem}
\begin{proof}
  From~\eqref{e:15},
  \begin{displaymath}
    |\tanh(2\phi)|=\frac{2|\tanh\phi|}{1+\tanh^2\phi}\le\frac{40}{41}\implies
    40\tanh^2\phi-82|\tanh\phi|+40\ge 0.
  \end{displaymath}
  This inequality is valid for $|\tanh\phi|\le 4/5$.
\end{proof}

\begin{lem}\label{l:2}
  Barring inexact underflow,
  \underline{$|a_{21}'|$}=$|a_{21}'|(1+\epsilon_1^{})|$,
  $|\epsilon_1^{}|\le\varepsilon$.
\end{lem}
\begin{proof}
  From the assumption that $\mathrm{hypot}$ is correctly rounded.
\end{proof}

\begin{lem}\label{l:3}
  With $|\epsilon_2|\le\varepsilon$, $|\epsilon_3|\le\varepsilon$, and
  $\epsilon_d$ such that
  \begin{equation}
    1+\epsilon_d=\frac{1+\epsilon_1}{1+\epsilon_2}(1+\epsilon_3),
    \label{e:21}
  \end{equation}
  barring inexact underflow it holds
  \begin{displaymath}
    \underline{\tanh(2\phi)}=\frac{-2|a_{21}'|(1+\epsilon_1^{})}{(a_{11}'+a_{22}')(1+\epsilon_2^{})}(1+\epsilon_3^{})=\tanh(2\phi)(1+\epsilon_d^{}).
  \end{displaymath}
\end{lem}
\begin{proof}
  From Lemma~\ref{l:2}.
\end{proof}
Note that
\begin{equation}
  \frac{(1-\varepsilon)^{\gamma}}{1+\varepsilon}\le 1+\epsilon_d\le\frac{(1+\varepsilon)^{\gamma}}{1-\varepsilon},
  \label{e:22}
\end{equation}
where $\gamma=2$ if $a_{21}'$ is complex, and $\gamma=1$ if
$a_{21}'$ is real (since then $\epsilon_1^{}=0$).

\begin{lem}\label{l:4}
  Assume that $|\tanh(2\phi)|\le 40/41$.  Then
  \begin{displaymath}
    1-(\underline{\tanh(2\phi)})^2=(1-\tanh^2(2\phi))(1+\epsilon_4),
  \end{displaymath}
  where
  \begin{displaymath}
    |\epsilon_4^{}|\le\frac{1600}{81}|\epsilon_d'|,\quad\epsilon_d'=(2+\epsilon_d^{})\epsilon_d^{}.
  \end{displaymath}
\end{lem}
\begin{proof}
  Let $y=1-\tanh^2(2\phi)\ge 81/1681$.  Then, from Lemma~\ref{l:3},
  \begin{displaymath}
    1-(\underline{\tanh(2\phi)})^2=1-\tanh^2(2\phi)(1+\epsilon_d^{})^2=y-\tanh^2(2\phi)\epsilon_d',
  \end{displaymath}
  where $(1+\epsilon_d^{})^2=1+\epsilon_d'$, i.e.,
  $\epsilon_d'=(2+\epsilon_d^{})\epsilon_d^{}$.

  Using the definition of $y$, find $\epsilon_4$ such that
  \begin{displaymath}
    y(1+\epsilon_4^{})=y+y\epsilon_4^{}=y-\tanh^2(2\phi)\epsilon_d'=y+(y-1)\epsilon_d'.
  \end{displaymath}
  Therefore, by subtracting $y$ from these equalities,
  \begin{displaymath}
    y\epsilon_4^{}=(y-1)\epsilon_d'\implies\epsilon_4^{}=\frac{y-1}{y}\epsilon_d'.
  \end{displaymath}
  By taking the lower bound for $y$, and thus the upper bound for
  $|y-1|/|y|$, it follows that
  \begin{displaymath}
    |\epsilon_4^{}|\le\frac{1600}{81}|\epsilon_d'|,
  \end{displaymath}
  i.e., $|\epsilon_4^{}|\lessapprox 19.753|\epsilon_d'|$.
\end{proof}

\begin{lem}\label{l:5}
  With $|\epsilon_5|\le\varepsilon$ and $|\epsilon_6|\le\varepsilon$,
  \begin{displaymath}
    \mathop{\mathrm{sqrt}}(\mathop{\mathrm{fma}}(-\underline{\tanh(2\phi)},\underline{\tanh(2\phi)},1))=\sqrt{1-\tanh^2(2\phi)}(1+\epsilon_7),
  \end{displaymath}
  where
  \begin{displaymath}
    1+\epsilon_7=\sqrt{(1+\epsilon_4)(1+\epsilon_5)}(1+\epsilon_6).
  \end{displaymath}
\end{lem}
\begin{proof}
  From Lemma~\ref{l:4} and the definition of $\mathrm{fma}$,
  \begin{displaymath}
    \mathop{\mathrm{fma}}(-\underline{\tanh(2\phi)},\underline{\tanh(2\phi)},1)=(1-(\underline{\tanh(2\phi)})^2)(1+\epsilon_5).
  \end{displaymath}
\end{proof}

\begin{lem}\label{l:6}
  Let $x=1+\sqrt{1-\tanh^2(2\phi)}$.  Then,
  \begin{displaymath}
    1+\mathop{\mathrm{sqrt}}(\mathop{\mathrm{fma}}(-\underline{\tanh(2\phi)},\underline{\tanh(2\phi)},1))=x(1+\epsilon_8),
  \end{displaymath}
  where $|\epsilon_8|\le|\epsilon_7|/2$.
\end{lem}
\begin{proof}
  From Lemma~\ref{l:5} it follows
  \begin{displaymath}
    1+\mathop{\mathrm{sqrt}}(\mathop{\mathrm{fma}}(-\underline{\tanh(2\phi)},\underline{\tanh(2\phi)},1))=1+(x-1)(1+\epsilon_7)=x+\epsilon_7(x-1).
  \end{displaymath}
  Using $50/41\le x\le 2$, since $1-\tanh^2(2\phi)\ge 81/1681$, find
  $\epsilon_8$ such that
  \begin{displaymath}
    x(1+\epsilon_8)=x+x\epsilon_8=x+\epsilon_7(x-1).
  \end{displaymath}
  From the last two equalities subtraction of $x$ gives
  \begin{displaymath}
    \epsilon_8=\frac{x-1}{x}\epsilon_7.
  \end{displaymath}
  Therefore,
  \begin{displaymath}
    \frac{9}{50}|\epsilon_7|\le|\epsilon_8|\le\frac{1}{2}|\epsilon_7|.
  \end{displaymath}
\end{proof}

\begin{lem}\label{l:7}
  The denominator in~\eqref{e:18} is computed as
  \begin{displaymath}
    (1+\sqrt{1-\tanh^2(2\phi)})(1+\epsilon_{10}),
  \end{displaymath}
  where, with $|\epsilon_9|\le\varepsilon$ due to the rounding in the
  final addition,
  \begin{displaymath}
    1+\epsilon_{10}=(1+\epsilon_8)(1+\epsilon_9).
  \end{displaymath}
\end{lem}
\begin{proof}
  From Lemma~\ref{l:6}.
\end{proof}

\begin{thm}\label{t:1}
  With $|\epsilon_{11}|\le\varepsilon$,
  \begin{equation}
    \underline{\tanh\phi}=\tanh\phi(1+\epsilon_t),\quad
    1+\epsilon_t=\frac{1+\epsilon_d}{1+\epsilon_{10}}(1+\epsilon_{11}).
    \label{e:23}
  \end{equation}
\end{thm}
\begin{proof}
  From~\eqref{e:18}, Lemma~\eqref{l:3}, and Lemma~\eqref{l:7}.
\end{proof}

\begin{lem}\label{l:8}
  With $\tanh\phi\le 4/5$ due to Lemma~\ref{l:1},
  \begin{displaymath}
    1-(\underline{\tanh\phi})^2=(1-\tanh^2\phi)(1+\epsilon_{12}),
  \end{displaymath}
  where
  \begin{displaymath}
    |\epsilon_{12}^{}|\le\frac{16}{9}|\epsilon_t'|,\quad
    \epsilon_t'=(2+\epsilon_t^{})\epsilon_t^{}.
  \end{displaymath}
\end{lem}
\begin{proof}
  As for Lemma~\ref{l:4}, using $z=1-\tanh^2\phi\ge 9/25$ instead of
  $y$.
\end{proof}

\begin{thm}\label{t:2}
  With $|\epsilon_{13}|\le\varepsilon$ and $|\epsilon_{14}|\le\varepsilon$,
  \begin{displaymath}
    \underline{\cosh\phi}=\cosh\phi(1+\epsilon_c),
  \end{displaymath}
  where, since $\mathrm{rsqrt}$ is assumed to be correctly rounded,
  \begin{equation}
    1+\epsilon_c=\frac{1+\epsilon_{14}}{\sqrt{(1+\epsilon_{12})(1+\epsilon_{13})}}.
    \label{e:24}
  \end{equation}
\end{thm}
\begin{proof}
  From~\eqref{e:19}, Lemma~\ref{l:8}, and the definition of $\mathrm{fma}$,
  \begin{displaymath}
    \mathop{\mathrm{fma}}(-\underline{\tanh\phi},\underline{\tanh\phi},1)=(1-(\underline{\tanh\phi})^2)(1+\epsilon_{13}).
  \end{displaymath}
\end{proof}

\begin{thm}\label{t:3}
  With $|\epsilon_{15}|\le\varepsilon$,
  \begin{equation}
    \underline{\sinh\phi}=\sinh\phi(1+\epsilon_s),\quad
    1+\epsilon_s=(1+\epsilon_t)(1+\epsilon_c)(1+\epsilon_{15}).
    \label{e:25}
  \end{equation}
\end{thm}
\begin{proof}
  From~\eqref{e:19}, Lemma~\ref{l:8}, and Theorem~\ref{t:2}.
\end{proof}

This completes the analysis if $a_{21}'$ is real.  Otherwise, with
$|\epsilon_{16}|\le\varepsilon$ and $|\epsilon_{17}|\le\varepsilon$,
and barring inexact underflow,
\begin{displaymath}
  \underline{\Re{e^{\mathrm{i}\beta}}}=\frac{\Re{a_{21}'}(1+\epsilon_{16}^{})}{|a_{21}'|(1+\epsilon_1^{})}=\Re{e^{\mathrm{i}\beta}}(1+\epsilon_{\Re}'),\quad
  \underline{\Im{e^{\mathrm{i}\beta}}}=\frac{\Re{a_{21}'}(1+\epsilon_{17}^{})}{|a_{21}'|(1+\epsilon_1^{})}=\Im{e^{\mathrm{i}\beta}}(1+\epsilon_{\Im}').
\end{displaymath}

\begin{thm}\label{t:4}
  With $|\epsilon_{18}|\le\varepsilon$ and
  $|\epsilon_{19}|\le\varepsilon$,
  \begin{displaymath}
    \underline{\Re{e^{\mathrm{i}\beta}}\sinh\phi}=\Re{e^{\mathrm{i}\beta}}\sinh\phi(1+\epsilon_{\Re}^{}),\quad
    \underline{\Im{e^{\mathrm{i}\beta}}\sinh\phi}=\Im{e^{\mathrm{i}\beta}}\sinh\phi(1+\epsilon_{\Im}^{}),
  \end{displaymath}
  where
  \begin{equation}
    1+\epsilon_{\Re}^{}=(1+\epsilon_{\Re}')(1+\epsilon_s^{})(1+\epsilon_{18}),\quad
    1+\epsilon_{\Im}^{}=(1+\epsilon_{\Im}')(1+\epsilon_s^{})(1+\epsilon_{19}).
    \label{e:26}
  \end{equation}
\end{thm}
\begin{proof}
  From Theorem~\ref{t:3}.
\end{proof}

Upper bounds on $|\epsilon_d|$, $|\epsilon_t|$, $|\epsilon_c|$,
$|\epsilon_s|$, $|\epsilon_{\Re}|$, and $|\epsilon_{\Im}|$ can be
obtained symbolically in the terms of $\varepsilon$ and $\gamma$.
\end{document}
